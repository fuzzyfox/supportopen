Array.prototype.shuffle||(Array.prototype.shuffle=function(){for(var j,x,i=this.length;i;j=parseInt(Math.random()*i,10),x=this[--i],this[i]=this[j],this[j]=x);});var query=window.query=function(window){"use strict";return function(queryString){queryString=queryString||window.location.search;var pairs=queryString.slice(1).split("&"),result={};return pairs.forEach(function(pair){pair=pair.split("="),result[pair[0]]=decodeURIComponent(pair[1]||"")}),JSON.parse(JSON.stringify(result))}}(this,this.document);!function(window,document){"use strict";function getMakes(page,done){page=page||1,makeapi.tags({tags:config.tags,execution:config.execution}).sortByField("createdAt","desc").limit(config.limit).contentType("application/x-thimble").page(page).then(function(err,makes){if(err)return void console.log(err);if(0!==makes.length){makes.shuffle();var $makes=$("#quiltMakes");makes.forEach(function(make){var thumbnail="https://secure.gravatar.com/avatar/"+make.emailHash+"?s=200&d="+make.thumbnail,thumb='<li class="quilt-msnry" data-make="'+make.url+'" style="background-image:url('+thumbnail+')">';thumb+='<a href="'+make.url+'">',thumb+='<img src="'+thumbnail+'" alt="'+make.title+" by "+make.user+'" /></a></li>',$makes.append(thumb),$quiltContainer.masonry("appended",$makes.children().last()),numberOfMakes++});for(var i=displayOrder.length,j=numberOfMakes;j>i;i++)displayOrder[i]=i;displayOrder.shuffle(),numberOfMakes<=config.limit&&done&&done()}})}function showNextMake(){var $makes=$("#quiltMakes").children(),selection=displayOrder.shift();displayOrder.push(selection),$makes.each(function(){$(this).removeClass("active")}),$makes.eq(selection).addClass("active"),$makePreview.attr("src",$makes.eq(selection).data("make")+"_")}function startDisplayTimer(){clearInterval(displayTimer),displayTimer=setInterval(showNextMake,config.duration)}function setContainerWidth(){$quiltContainer.width(160*Math.floor($quiltContainer.parent().width()/160))}function Quilt(userConfig){userConfig=userConfig||{},$.extend(config,userConfig,urlConfig),getMakes(pageNumber,function(){startDisplayTimer()}),getMakes(++pageNumber,function getNextMakes(){getMakes(++pageNumber,getNextMakes)}),$(window).scroll(function(){$(window).scrollTop()===$(document).height()-$(window).height()&&getMakes(pageNumber+1,function(){pageNumber++,startDisplayTimer()})})}var deps=[window.jQuery,window.Make,window.Masonry,window.query,Array.prototype.shuffle],missingDepsFlag=!1;if(deps.forEach(function(dep){dep||(missingDepsFlag=!0)}),!missingDepsFlag){var makeapi=new window.Make({apiURL:"https://makeapi.webmaker.org"}),$=window.jQuery,$quiltContainer=$("#quiltContainer"),$makePreview=$("#makePreview");$quiltContainer.masonry({itemSelector:".quilt-msnry",columnWidth:160,transitionDuration:.7});var config={tags:["supportopen","webwewant","millionmozillians"],execution:"or",limit:100,duration:7e3},urlConfig=window.query();urlConfig.tags&&(urlConfig.tags=urlConfig.tags.split(","));var numberOfMakes=0,pageNumber=1,displayOrder=[],displayTimer=null;$("#quiltMakes").on("click","li",function(){$makePreview.attr("src",$(this).data("make")+"_");var $makes=$("#quiltMakes").children();return $makes.each(function(){$(this).removeClass("active")}),$(this).addClass("active"),startDisplayTimer(),!1}),setContainerWidth(),$(window).resize(setContainerWidth),window.Quilt=Quilt}}(this,this.document);
//# sourceMappingURL=quilt.min.map