"use strict";function quilt($,Make,Masonry){function shuffleArray(array){var randomIndex=0,tempValue=null,length=array.length;if(2>length)return array;for(;length;)randomIndex=Math.floor(Math.random()*length),length--,tempValue=array[length],array[length]=array[randomIndex],array[randomIndex]=tempValue;return array}function getMakes(page,done){page=page||1,makeapi.tags({tags:config.tags,execution:config.execution}).sortByField("createdAt","desc").limit(config.limit).contentType("application/x-thimble").page(page).then(function(err,makes){return err?void console.error(err):void(0!==makes.length&&(makes=shuffleArray(makes),makes.forEach(function(make){var avatar="https://secure.gravatar.com/avatar/"+make.emailHash+"?s=200&d="+make.thumbnail,thumb='<li class="quilt-msnry" data-make-url="'+make.url+'" style="background-image:url('+avatar+')">\n  <a href="'+make.url+'">\n    <img src="'+avatar+'" alt="'+make.title+" by "+make.user+'" />\n  </a>\n</li>';config.$makesContainer.append(thumb),Masonry&&masonry.appended(config.$makesContainer.children().last().get(0)),previewOrder.push(totalMakes),totalMakes++}),previewOrder=shuffleArray(previewOrder),totalMakes<=config.limit&&done&&done()))})}function previewMake($selection){var $makes=config.$makesContainer.children();if(!$selection){var selection=previewOrder.shift();previewOrder.push(selection),$selection=$makes.eq(selection)}$makes.filter(".active").removeClass("active"),$selection.addClass("active"),config.$preview.attr("src",$selection.data("make-url")+"_")}function startPreviewInterval(){clearInterval(previewInterval),previewInterval=setInterval(previewMake,config.duration)}function centerContainer(){config.$quiltContainer.width(160*Math.floor(config.$quiltContainer.parent().width()/160))}var makeapi,masonry,previewInterval,called=!1,config={tags:["supportopen","webwewant","millionmozillians"],execution:"or",limit:100,duration:7e3,makeapi:{apiURL:"https://makeapi.webmaker.org"},$quiltContainer:$("#quiltContainer"),$makesContainer:$("#quiltMakes"),$preview:$("#quiltPreview"),centerQuilt:!0},totalMakes=0,previewOrder=[];return config.$makesContainer.on("click","li",function(){return previewMake($(this)),startPreviewInterval(),!1}),function(options){called||(called=!0,options=options||{},$.extend(config,options),makeapi=new Make(config.makeapi),Masonry&&(masonry=new Masonry(config.$quiltContainer.get(0),{itemSelector:".quilt-msnry",columnWidth:160,transitionDuration:.7})),getMakes(1,function(){startPreviewInterval()}),config.centerQuilt&&(centerContainer(),$(window).resize(centerContainer)))}}"undefined"!=typeof define?define(["jquery","makeapi","masonry"],quilt):window.Quilt=quilt(jQuery,Make,Masonry);
//# sourceMappingURL=quilt.min.map